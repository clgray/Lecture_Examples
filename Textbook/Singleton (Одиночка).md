# Singleton (–û–¥–∏–Ω–æ—á–∫–∞)

## –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ

**Singleton (–û–¥–∏–Ω–æ—á–∫–∞)**

---

## –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–∞–µ–º–æ–π –ø—Ä–æ–±–ª–µ–º—ã

**–ü—Ä–æ–±–ª–µ–º–∞:** —Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ä–æ–≤–Ω–æ –æ–¥–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ (–∏–ª–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–º –¥–æ–º–µ–Ω–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —ç–∫–∑–µ–º–ø–ª—è—Ä—É.

**–ö–æ–≥–¥–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç:**

* –ù—É–∂–Ω–æ –æ–¥–Ω–æ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –∫—ç—à, –º–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ—Å—É—Ä—Å–æ–≤).
* –ù—É–∂–µ–Ω –æ–±—â–∏–π —Å–µ—Ä–≤–∏—Å —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ (–ª–æ–≥–≥–µ—Ä, –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –ø—É–ª —Ä–µ—Å—É—Ä—Å–æ–≤, –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫).
* –ñ–µ–ª–∞–Ω–∏–µ –∏–∑–±–µ–∂–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ç—è–∂—ë–ª—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, expensive-to-create factory).

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–¥–∞—á:**

* –õ–æ–≥–≥–µ—Ä: –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø–∏—Å–∞—Ç—å –≤ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –ª–æ–≥.
* –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
* –ú–µ–Ω–µ–¥–∂–µ—Ä —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π/–ø—É–ª–æ–≤: —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏.
* –ö—ç—à –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –æ–±—â–∞—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º –≤ –ø–∞–º—è—Ç–∏.

---

## –û–ø–∏—Å–∞–Ω–∏–µ —Å–ø–æ—Å–æ–±–∞ —Ä–µ—à–µ–Ω–∏—è

–ò–¥–µ—è –ø—Ä–æ—Å—Ç–∞:

1. –ó–∞–∫—Ä—ã—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É –∫–ª–∞—Å—Å–∞ (private ctor).
2. –•—Ä–∞–Ω–∏—Ç—å –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä.
3. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥/—Å–≤–æ–π—Å—Ç–≤–æ (–Ω–∞–ø—Ä., `Instance`), –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç—Ç–æ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä, —Å–æ–∑–¥–∞–≤–∞—è –µ–≥–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

–ö–ª—é—á–µ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

* **–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** —Å–æ–∑–¥–∞–Ω–∏–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º.
* **–û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (lazy):** —Å–æ–∑–¥–∞–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏.
* **–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/—Ä–µ—Ñ–ª–µ–∫—Å–∏—è:** –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ø–∏–π —á–µ—Ä–µ–∑ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é –∏–ª–∏ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ.
* **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å:** –æ–¥–∏–Ω–æ—á–∫–∞ —Å–æ–∑–¥–∞—ë—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —É—Å–ª–æ–∂–Ω—è–µ—Ç –º–æ–¥—É–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –≤–∞–∂–Ω–æ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ—á–∫–∏ –ø–æ–¥–º–µ–Ω—ã/–∏–Ω—ä–µ–∫—Ü–∏–∏.

---

## –î–∏–∞–≥—Ä–∞–º–º–∞ –∏ —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### UML  ‚Äî –¥–∏–∞–≥—Ä–∞–º–º–∞ –∫–ª–∞—Å—Å–æ–≤

```plantuml
@startuml
class Singleton {
  - static instance : Singleton
  - Singleton() <<private>>
  + static Instance : Singleton
  + SomeBusinessMethod()
}

Singleton ..> "1" Singleton : returns
@enduml
```

### UML ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (Sequence) —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ (lazy)

```plantuml
@startuml
actor Client
participant "Singleton" as S

Client -> S : get Instance()
alt instance == null
    S -> S : lock
    alt instance == null
        S -> S : new Singleton()
        S --> S : instance assigned
    end
    S -> S : unlock
end
S --> Client : return instance
@enduml
```

---

## –°–ø–æ—Å–æ–±—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ C#

### 1) –ü—Ä–æ—Å—Ç–µ–π—à–∞—è (–Ω–µ–ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è)

```csharp
public sealed class SingletonSimple
{
    private static SingletonSimple _instance;
    private SingletonSimple() { }

    public static SingletonSimple Instance
    {
        get
        {
            if (_instance == null)
                _instance = new SingletonSimple();
            return _instance;
        }
    }

    public void DoWork() { /* ... */ }
}
```

**–ö–æ–≥–¥–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç:** –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –∫–æ–≥–¥–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤–Ω–µ—à–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è. –í –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö ‚Äî **–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ**.

---

### 2) Thread-safe —Å lock (Double-check locking)

```csharp
public sealed class SingletonDoubleCheck
{
    private static SingletonDoubleCheck _instance;
    private static readonly object _sync = new object();
    private SingletonDoubleCheck() { }

    public static SingletonDoubleCheck Instance
    {
        get
        {
            // –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –∑–∞—Ö–≤–∞—Ç–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            if (_instance == null)
            {
                lock (_sync)
                {
                    if (_instance == null)
                    {
                        _instance = new SingletonDoubleCheck();
                    }
                }
            }
            return _instance;
        }
    }

    public void DoWork() { /* ... */ }
}
```

**–ü–æ—è—Å–Ω–µ–Ω–∏–µ:** –¥–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —É–º–µ–Ω—å—à–∞–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –Ω–∞ lock –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏. –í C# —ç—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—á–∏–Ω–∞—è —Å .NET 2.0 –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `volatile` –∏–ª–∏ –∫–æ–≥–¥–∞ `_instance` ‚Äî reference type –∏ –ø–∞–º—è—Ç—å —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∞ –¥–æ–ª–∂–Ω—ã–º –æ–±—Ä–∞–∑–æ–º; –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –ø–æ–º–µ—Ç–∏—Ç—å –ø–æ–ª–µ `volatile`:

```csharp
private static volatile SingletonDoubleCheck _instance;
```

---

### 3) –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ (eager, thread-safe)

```csharp
public sealed class SingletonStatic
{
    private static readonly SingletonStatic _instance = new SingletonStatic();
    private SingletonStatic() { }

    public static SingletonStatic Instance => _instance;

    public void DoWork() { /* ... */ }
}
```

**–ü–æ—è—Å–Ω–µ–Ω–∏–µ:** CLR –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π. –≠–∫–∑–µ–º–ø–ª—è—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ —Ç–∏–ø—É (–∏–ª–∏ —Ä–∞–Ω—å—à–µ ‚Äî –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ç–∏–ø–∞), –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–µ –Ω—É–∂–Ω—ã. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ (eager) ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

---

### 4) –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± ‚Äî `Lazy<T>`

```csharp
public sealed class SingletonLazy
{
    private static readonly Lazy<SingletonLazy> _lazyInstance =
        new Lazy<SingletonLazy>(() => new SingletonLazy());

    private SingletonLazy() { }

    public static SingletonLazy Instance => _lazyInstance.Value;

    public void DoWork() { /* ... */ }
}
```

**–ü–æ—è—Å–Ω–µ–Ω–∏–µ:** `Lazy<T>` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç–ª–æ–∂–µ–Ω–Ω—É—é –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (`LazyThreadSafetyMode`). –≠—Ç–æ –∫–æ–º–ø–∞–∫—Ç–Ω–æ –∏ –Ω–∞–¥—ë–∂–Ω–æ.

---

### 5) –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—á—Ç–æ–±—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –ø—Ä–∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏)

–ï—Å–ª–∏ –≤–∞—à Singleton —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º, –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä. –í .NET –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `ISerializable` –∏ `IObjectReference`:

```csharp
[Serializable]
public sealed class SingletonSerializable : System.Runtime.Serialization.IObjectReference,
                                            System.Runtime.Serialization.ISerializable
{
    private static readonly SingletonSerializable _instance = new SingletonSerializable();
    private SingletonSerializable() { }

    public static SingletonSerializable Instance => _instance;

    // ISerializable
    void System.Runtime.Serialization.ISerializable.GetObjectData(
        System.Runtime.Serialization.SerializationInfo info,
        System.Runtime.Serialization.StreamingContext context)
    {
        // –ù—É–∂–µ–Ω –ø—É—Å—Ç–æ–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GetRealObject
    }

    // IObjectReference
    public object GetRealObject(System.Runtime.Serialization.StreamingContext context)
    {
        // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        return Instance;
    }
}
```

---

### 6) –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Ä–∞–∂–µ–Ω–∏—è (reflection)

–û—Ç—Ä–∞–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤—ã–∑–≤–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä. –ß–∞—Å—Ç–∏—á–Ω–∞—è –∑–∞—â–∏—Ç–∞ ‚Äî –±—Ä–æ—Å–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä:

```csharp
public sealed class SingletonReflectionSafe
{
    private static bool _isInstanceCreated = false;
    private static readonly object _sync = new object();
    private SingletonReflectionSafe()
    {
        if (_isInstanceCreated)
            throw new InvalidOperationException("Singleton instance already created.");
        _isInstanceCreated = true;
    }

    private static readonly Lazy<SingletonReflectionSafe> _lazy =
        new Lazy<SingletonReflectionSafe>(() => new SingletonReflectionSafe());

    public static SingletonReflectionSafe Instance => _lazy.Value;
}
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:** —ç—Ç–æ –Ω–µ –¥–∞—ë—Ç 100%-–Ω–æ–π –∑–∞—â–∏—Ç—ã (—Ä–µ—Ñ–ª–µ–∫—Å–∏—è –≤—Å—ë –µ—â—ë –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –ø–æ–ª—è/—Ñ–ª–∞–≥–∏), –Ω–æ –∑–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞.

---

## –ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã, –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è, –ø—Ä–∏–º–µ—Ä—ã

### –ü–ª—é—Å—ã

* –ì–∞—Ä–∞–Ω—Ç–∏—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∏ –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞.
* –ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤—Ä–µ–º–µ–Ω–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (lazy/eager).
* –£–¥–æ–±—Å—Ç–≤–æ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–º–∏ –¥–æ–ª–∂–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç (–ª–æ–≥–≥–µ—Ä, –∫—ç—à –∏ —Ç.–¥.).
* –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏).

### –ú–∏–Ω—É—Å—ã

* **–ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** ‚Äî Singleton –≤–≤–æ–¥–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —É—Å–ª–æ–∂–Ω—è—è –∞–Ω–∞–ª–∏–∑ –∏ –º–æ–¥—É–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–µ—Å—Ç—ã –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞).
* **–°–∫—Ä—ã—Ç—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** ‚Äî –∫–æ–¥ –∑–∞–≤–∏—Å—è—â–∏–π –æ—Ç `Singleton.Instance` –ø–æ–ª—É—á–∞–µ—Ç —Å–∫—Ä—ã—Ç—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (—Å–ª–æ–∂–Ω–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏).
* **–ü—Ä–æ–±–ª–µ–º—ã —Å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º** ‚Äî —Å–ª–æ–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è/–æ—á–∏—Å—Ç–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ –±–æ–ª—å—à–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –ø–ª–∞–≥–∏–Ω–∞—Ö).
* **–ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≥—Ä—É–∑–∫–æ–π/–ø—É–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å—Ä–µ–¥–∞—Ö —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –¥–æ–º–µ–Ω–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –ø—Ä–∏ hot-reload).
* –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ **–≥–æ–Ω–∫–∞–º** –∏ **condition race**.
* –ú–æ–∂–µ—Ç —Å—Ç–∞—Ç—å ¬´–∞–Ω—Ç–∏-—à–∞–±–ª–æ–Ω–æ–º¬ª, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ —è–≤–Ω–æ–π –∏–Ω–≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Injection).

### –û–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (–∫–æ–≥–¥–∞ —Ö–æ—Ä–æ—à–∏–π –≤—ã–±–æ—Ä)

* –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã: –ª–æ–≥–≥–µ—Ä—ã, –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –º–µ—Ç—Ä–∏–∫.
* –û–±—ä–µ–∫—Ç—ã, —á—å—è —Å–µ–º–∞–Ω—Ç–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞.
* Legacy-–∫–æ–¥, –≥–¥–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ DI –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–æ.

### –ö–æ–≥–¥–∞ **–Ω–µ** —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

* –ö–æ–≥–¥–∞ –≤–∞–∂–Ω–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ —É–¥–æ–±—Å—Ç–≤–æ –∑–∞–º–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Äî –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Dependency Injection.
* –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö/—Å–∫–æ–ø–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, per-request).
* –ö–æ–≥–¥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–æ–∂–Ω–æ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞—Ç—å ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–≤—ã—à–∞–µ—Ç —Å–ª–∏—è–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

* –õ–æ–≥–≥–µ—Ä (`Logger.Instance.Log("...")`)
* –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`ConfigurationManager.Instance.Get("...")`)
* –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫—ç—à (`Cache.Instance`)
* –§–∞–±—Ä–∏–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –≥–¥–µ —Ä–µ—Å—É—Ä—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª–µ–Ω

---

## –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ

1. **–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ DI**: –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (DI), –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å –∫–∞–∫ singleton / single instance –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ ‚Äî —ç—Ç–æ –¥–∞—ë—Ç —è–≤–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —É–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.
2. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ** –ø–æ—á–µ–º—É –∫–ª–∞—Å—Å ‚Äî –æ–¥–∏–Ω–æ—á–∫–∞ –∏ –∑–∞—á–µ–º –Ω—É–∂–µ–Ω. –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è.
3. **–ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–π—Ç–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** –≤ –æ–¥–∏–Ω–æ—á–∫–∞—Ö. –õ—É—á—à–µ, –µ—Å–ª–∏ Singleton –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ä–≤–∏—Å—ã –±–µ–∑ –±–æ–ª—å—à–æ–≥–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –∏–∑–º–µ–Ω—è–µ–º–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Lazy<T>`** –¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–π –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ª–µ–Ω–∏–≤–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
5. **–ó–∞—â–∏—â–∞–π—Ç–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é/—Ä–µ—Ñ–ª–µ–∫—Å–∏—é**, –µ—Å–ª–∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤.

---

## –ö—Ä–∞—Ç–∫–∞—è —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π (C#)

| –ü–æ–¥—Ö–æ–¥                | –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å |      –õ–µ–Ω–∏–≤–æ—Å—Ç—å | –ü—Ä–æ—Å—Ç–æ—Ç–∞ | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è                               |
| --------------------- | -----------------: | -------------: | -------: | ------------------------------------------ |
| –ü—Ä–æ—Å—Ç–∞—è (–±–µ–∑ lock)    |                  ‚ùå |              ‚úÖ |        ‚úì | –¢–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–≥–æ                   |
| `lock` (double-check) |                  ‚úÖ |              ‚úÖ |  —Å—Ä–µ–¥–Ω—è—è | –•–æ—Ä–æ—à–æ, –Ω–æ –±–æ–ª–µ–µ –º–Ω–æ–≥–æ—Å–ª–æ–≤–Ω–æ               |
| –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª–µ      |            ‚úÖ (CLR) | –Ω–µ—Ç/–æ–ø–µ—Ä–µ–∂–∞—é—â–µ |        ‚úì | –ü—Ä–æ—Å—Ç–∞—è –∏ –Ω–∞–¥—ë–∂–Ω–∞—è –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤ |
| `Lazy<T>`             |                  ‚úÖ |              ‚úÖ |        ‚úì | –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±       |

---
–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥—ë–Ω **–Ω–∞–≥–ª—è–¥–Ω—ã–π –ø—Ä–∏–º–µ—Ä**, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π:
1Ô∏è‚É£ –∫–∞–∫ **Singleton –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º** (–∂—ë—Å—Ç–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —Ç—Ä—É–¥–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –∏–Ω–≤–µ—Ä—Å–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π),
2Ô∏è‚É£ –∏ –∫–∞–∫ **—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Dependency Injection (DI)** —Ä–µ—à–∞–µ—Ç —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã.

---

# ‚ùå –ü–ª–æ—Ö–æ–π –ø—Ä–∏–º–µ—Ä: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Singleton –Ω–∞–ø—Ä—è–º—É—é

```csharp
using System;

public sealed class Logger
{
    private static readonly Logger _instance = new Logger();
    private Logger() { }

    public static Logger Instance => _instance;

    public void Log(string message)
    {
        Console.WriteLine($"[{DateTime.Now:HH:mm:ss}] {message}");
    }
}

// –°–µ—Ä–≤–∏—Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
public class OrderService
{
    public void PlaceOrder(string product)
    {
        Logger.Instance.Log($"–ù–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞: {product}");
        // ... –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ ...
        Logger.Instance.Log($"–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω: {product}");
    }
}

// –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
public class Program
{
    public static void Main()
    {
        var service = new OrderService();
        service.PlaceOrder("Notebook");
    }
}
```

### üö® –ü—Ä–æ–±–ª–µ–º—ã —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

| –ü—Ä–æ–±–ª–µ–º–∞                     | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                                                       |
| ---------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| üîí –ñ—ë—Å—Ç–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å       | `OrderService` *–∂—ë—Å—Ç–∫–æ –ø—Ä–∏–≤—è–∑–∞–Ω* –∫ `Logger.Instance` –∏ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –Ω–µ–≥–æ.                                                                             |
| üß™ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å | –í —Ç–µ—Å—Ç–∞—Ö –Ω–µ–ª—å–∑—è –ø–æ–¥–º–µ–Ω–∏—Ç—å –ª–æ–≥–≥–µ—Ä, —á—Ç–æ–±—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å, –∞ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –ø–∞–º—è—Ç—å.                                                                |
| ‚ôªÔ∏è –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ      | –õ–æ–≥–≥–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –æ—Ç–æ–≤—Å—é–¥—É, —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç —Ä–∏—Å–∫ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–æ–¥—É–ª–µ–π.                                                                             |
| üß© –ù–∞—Ä—É—à–µ–Ω–∏–µ SOLID           | –ù–∞—Ä—É—à–∞–µ—Ç—Å—è **Dependency Inversion Principle (DIP)** ‚Äî –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –º–æ–¥—É–ª—å (`OrderService`) –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (`Logger`), –∞ –Ω–µ –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏. |
| üö´ –ü–ª–æ—Ö–∞—è —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å      | –î–æ–±–∞–≤–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª –∏–ª–∏ —É–¥–∞–ª—ë–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä ‚Äî —Ç—Ä—É–¥–Ω–æ, –≤—Å—ë –ø—Ä–∏–¥—ë—Ç—Å—è –º–µ–Ω—è—Ç—å –≤—Ä—É—á–Ω—É—é.                                                             |

---

# ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥: —á–µ—Ä–µ–∑ Dependency Injection (DI)

## 1. –í–≤–æ–¥–∏–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ª–æ–≥–≥–µ—Ä–∞

```csharp
public interface ILogger
{
    void Log(string message);
}
```

## 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–≥–µ—Ä–∞ (—Ç–µ–ø–µ—Ä—å —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ–±—ã—á–Ω—ã–π –∫–ª–∞—Å—Å)

```csharp
public class ConsoleLogger : ILogger
{
    public void Log(string message)
    {
        Console.WriteLine($"[{DateTime.Now:HH:mm:ss}] {message}");
    }
}
```

## 3. –ö–ª–∞—Å—Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

```csharp
public class OrderService
{
    private readonly ILogger _logger;

    public OrderService(ILogger logger)
    {
        _logger = logger;
    }

    public void PlaceOrder(string product)
    {
        _logger.Log($"–ù–∞—á–∞–ª–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞: {product}");
        // ... –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ ...
        _logger.Log($"–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω: {product}");
    }
}
```

## 4. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∫–æ–º–ø–æ–∑–∏—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

```csharp
public class Program
{
    public static void Main()
    {
        ILogger logger = new ConsoleLogger();
        var service = new OrderService(logger);

        service.PlaceOrder("Notebook");
    }
}
```

---

# üß™ –¢–µ–ø–µ—Ä—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–µ–≥–∫–æ

```csharp
using System.Collections.Generic;

public class FakeLogger : ILogger
{
    public List<string> Messages { get; } = new List<string>();
    public void Log(string message) => Messages.Add(message);
}

public class OrderServiceTests
{
    public void Test_OrderLogging()
    {
        var fakeLogger = new FakeLogger();
        var service = new OrderService(fakeLogger);

        service.PlaceOrder("TestProduct");

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
        if (fakeLogger.Messages.Count != 2)
            throw new Exception("Logging failed!");

        Console.WriteLine("‚úÖ –¢–µ—Å—Ç –ø—Ä–æ—à—ë–ª —É—Å–ø–µ—à–Ω–æ");
    }
}

public static class TestRunner
{
    public static void Main()
    {
        new OrderServiceTests().Test_OrderLogging();
    }
}
```

---

# üí° –ß—Ç–æ –º—ã –≤—ã–∏–≥—Ä–∞–ª–∏

| –ë—ã–ª–æ (Singleton)          | –°—Ç–∞–ª–æ (DI)                                                                       |
| ------------------------- | -------------------------------------------------------------------------------- |
| –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ      | –ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è                                                        |
| –ñ—ë—Å—Ç–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å       | –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å                                                      |
| –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å | –ú–æ–∂–Ω–æ –ø–æ–¥–º–µ–Ω–∏—Ç—å `ILogger`                                                        |
| –ù–∞—Ä—É—à–µ–Ω DIP               | DIP —Å–æ–±–ª—é–¥—ë–Ω                                                                     |
| –°–ª–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å          | –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –ª–æ–≥–≥–µ—Ä–æ–≤ (—Ñ–∞–π–ª, –±–∞–∑–∞, REST) –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–∫–æ–¥–∞ |

---

# üåê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–ø—Ä–∏–º–µ—Ä —Å Microsoft.Extensions.DependencyInjection)

```csharp
using Microsoft.Extensions.DependencyInjection;

var services = new ServiceCollection();
services.AddSingleton<ILogger, ConsoleLogger>();
services.AddTransient<OrderService>();

var provider = services.BuildServiceProvider();
var orderService = provider.GetRequiredService<OrderService>();

orderService.PlaceOrder("Laptop");
```

**–ü–æ—è—Å–Ω–µ–Ω–∏–µ:**

* `AddSingleton<ILogger, ConsoleLogger>()` ‚Äî —Å–æ–∑–¥–∞—ë—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –ª–æ–≥–≥–µ—Ä–∞ (–∞–Ω–∞–ª–æ–≥ Singleton, –Ω–æ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º).
* `AddTransient<OrderService>()` ‚Äî —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ.
* DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–µ—Ä—ë—Ç –Ω–∞ —Å–µ–±—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏.

---

# üß≠ –í—ã–≤–æ–¥

| –ü–æ–¥—Ö–æ–¥                   | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å                                                                                                                                                |
| ------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Singleton**            | –ö–æ–≥–¥–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç, –∏ –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º API, low-level logging, –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏). |
| **Dependency Injection** | –ö–æ–≥–¥–∞ –≤–∞–∂–Ω—ã —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å, —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å –∏ –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å. –ü—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.                                                       |

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Singleton —Ä–µ—à–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∏ –ø—Ä–æ—Å—Ç—É—é –∑–∞–¥–∞—á—É ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∏ –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞. –ü—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∏ —Å —É—á—ë—Ç–æ–º —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏/—Ä–µ—Ñ–ª–µ–∫—Å–∏–∏) –æ–Ω –ø–æ–ª–µ–∑–µ–Ω, –Ω–æ –æ–±–ª–∞–¥–∞–µ—Ç –ø–æ–±–æ—á–Ω—ã–º–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏: –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å–Ω–∏–∂–µ–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏ –∏ —Å–∫—Ä—ã—Ç—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —á–∞—Å—Ç–æ –ª—É—á—à–µ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É–∂–±—ã –∫–∞–∫ –æ–¥–∏–Ω–æ—á–∫–∏ –≤ DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏ –∏ –æ–±–ª–µ–≥—á–∞—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

---


